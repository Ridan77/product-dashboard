<h1>{{ isEditMode ? 'Edit Product' : 'New Product' }}</h1>

<p *ngIf="error" class="error">{{ error }}</p>
<!-- Product image (edit mode only) -->
<div *ngIf="isEditMode && !loading" class="image-preview">
    <img class="product-image" [src]="getImageUrl(form.get('name')?.value)" [alt]="form.get('name')?.value" />
</div>

<form [formGroup]="form" (ngSubmit)="submit()">
    <label>
        Name
        <input formControlName="name" />
    </label>
    <p *ngIf="form.get('name')?.touched && form.get('name')?.invalid">
        Name is required (min 3 chars)
    </p>

    <label>
        Description
        <textarea formControlName="description"></textarea>
    </label>
    <p *ngIf="form.get('description')?.touched && form.get('description')?.invalid">
        Description is required
    </p>

    <label>
        Price
        <input type="number" formControlName="price" />
    </label>
    <p *ngIf="form.get('price')?.touched && form.get('price')?.invalid">
        Price is required
    </p>

    <label>
        Currency
        <select formControlName="currency">
            <option value="USD">USD</option>
            <option value="EUR">EUR</option>
            <option value="ILS">ILS</option>
        </select>
    </label>


    <label>
        Category
        <input formControlName="category" />
    </label>

    <label>
        Stock
        <input type="number" formControlName="stock" />
    </label>
    <p *ngIf="form.get('stock')?.touched && form.get('stock')?.invalid">
        Stock is required
    </p>
    <label>
        Active
        <input type="checkbox" formControlName="isActive" />
    </label>

    <button type="submit" [disabled]="loading || form.invalid">
        {{ loading ? 'Saving...' : 'Save' }}
    </button>
</form>