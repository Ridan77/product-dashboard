<div class="main-container">

    <div class="header">
        <div class="main-header">
            <h1>Products Dashboard</h1>
            <!-- Create -->
            <button mat-raised-button color="primary" (click)="createProduct()">
                New Product
            </button>
        </div>
        <div class="filters">
            <!-- Search -->
            <mat-form-field appearance="outline" class="search">
                <mat-label>Search products</mat-label>
                <input matInput placeholder="Search products..." [formControl]="searchControl" />
            </mat-form-field>
            <!-- Category -->
            <mat-form-field appearance="outline">
                <mat-label>Category</mat-label>
                <mat-select [value]="query.category" (selectionChange)="onCategoryChange($event.value)">
                    <mat-option value="">All Categories</mat-option>
                    <mat-option *ngFor="let category of categories" [value]="category">
                        {{ category }}
                    </mat-option>
                </mat-select>
            </mat-form-field>
            <!-- Sort -->
            <mat-form-field appearance="outline">
                <mat-label>Sort by</mat-label>
                <mat-select [value]="query.sortBy" (selectionChange)="onSortChange($event.value)">
                    <mat-option value="createdAt">Newest</mat-option>
                    <mat-option value="price">Price</mat-option>
                    <mat-option value="name">Name</mat-option>
                </mat-select>
            </mat-form-field>
        </div>
    </div>

    <!-- Loading -->
    <p class="msg-or-err" *ngIf="loading">Loading products...</p>

    <!-- Error -->
    <p class="msg-or-err error" *ngIf="error">{{ error }}</p>

    <!-- Empty -->
    <p class="msg-or-err" *ngIf="!loading && !error && products.length === 0">
        No products found.
    </p>

    <!-- Cards -->
    <div class="list-content" *ngIf="!loading && !error && products.length > 0">
        <div class="products-grid">
            <div class="product-card" *ngFor="let product of products">
                <div class="card-header">
                    <h3>{{ product.name }}</h3>
                    <p class="description">
                        {{ product.description || 'No description available.' }}
                    </p>
                </div>
                <!-- Image -->
                <img class="product-image" [src]="getImageUrl(product.name)" [alt]="product.name" />
                <div class="card-content">
                    <span class="price">
                        {{ product.price }} {{ product.currency }}
                    </span>

                    <p class="category">{{ product.category }}</p>
                </div>

                <div class="card-actions">
                    <button mat-raised-button color="primary" (click)="editProduct(product.id)">
                        Edit
                    </button>
                </div>
            </div>
        </div>

    </div>
    <!-- Pagination -->
    <div class="pagination" *ngIf="!loading && !error">
        <button mat-raised-button color="primary" (click)="prevPage()" [disabled]="query.page === 1">
            Previous
        </button>
        <span>Page {{ query.page }} / {{ totalPages }}</span>
        <button mat-raised-button color="primary" (click)="nextPage()" [disabled]="!hasNext">
            Next
        </button>

    </div>
</div>